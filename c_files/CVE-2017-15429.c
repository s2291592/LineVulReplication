  explicit WasmDataLoaderClient() {}

  FetchDataLoaderAsWasmModule(ScriptState* script_state)
      : builder_(script_state->GetIsolate()), script_state_(script_state) {}

  void AbortCompilation() {
    builder_.Abort(V8ThrowException::CreateTypeError(
        script_state_->GetIsolate(), "Could not download wasm module"));
  }

  void Trace(blink::Visitor* visitor) {
    visitor->Trace(consumer_);
    visitor->Trace(client_);
    FetchDataLoader::Trace(visitor);
    BytesConsumer::Client::Trace(visitor);
  }

void WasmCompileStreamingImpl(const v8::FunctionCallbackInfo<v8::Value>& args) {
v8::Isolate* isolate = args.GetIsolate();
  ScriptState* script_state = ScriptState::ForRelevantRealm(args);

v8::Local<v8::Function> compile_callback =
v8::Function::New(isolate, CompileFromResponseCallback);

// treat either case of parameter as
// Promise.resolve(parameter)
// as per https://www.w3.org/2001/tag/doc/promises-guide#resolve-arguments

// Ending with:
//    return Promise.resolve(parameter).then(compileCallback);
V8SetReturnValue(args, ScriptPromise::Cast(script_state, args[0])
.Then(compile_callback)
.V8Value());

}

  v8::Local<v8::Promise> GetPromise() { return builder_.GetPromise(); }
